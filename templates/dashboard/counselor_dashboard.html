{% extends 'base.html' %}

{% block content %}
<style>
    .dashboard-header {
        background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
        color: white;
        padding: 40px;
        border-radius: 15px;
        margin-bottom: 30px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }
    .action-cards {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-bottom: 40px;
    }
    .action-card {
        background: white;
        padding: 25px;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        text-align: center;
        transition: transform 0.2s;
        text-decoration: none;
        color: inherit;
        border: 1px solid #eee;
    }
    .action-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        border-color: #38ef7d;
    }
    .action-icon {
        font-size: 2.5em;
        margin-bottom: 15px;
        display: block;
    }
    .action-title {
        font-weight: bold;
        font-size: 1.2em;
        color: #333;
    }
    .alerts-section {
        background: white;
        padding: 30px;
        border-radius: 15px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        border-top: 5px solid #dc2626;
    }
    .alerts-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
    }
    .alerts-table th {
        text-align: left;
        padding: 15px;
        background-color: #fee2e2;
        color: #991b1b;
        font-weight: 600;
        border-bottom: 2px solid #fecaca;
    }
    .alerts-table td {
        padding: 15px;
        border-bottom: 1px solid #eee;
        color: #444;
    }
    .btn-action {
        background: #007bff;
        color: white; 
        padding: 5px 15px; 
        text-decoration: none; 
        border-radius: 20px;
        font-size: 0.9em;
        transition: opacity 0.2s;
        display: inline-block;
    }
    .btn-action:hover {
        opacity: 0.8;
    }
</style>

<div class="dashboard-header">
    <h1 style="margin: 0;">Counselor Dashboard</h1>
    <p style="margin-top: 10px; opacity: 0.9;">Overview of student mental health status and alerts.</p>
</div>

<div class="action-cards">
    <a href="{{ url_for('chat.hub') }}" class="action-card">
        <span class="action-icon">ðŸ’¬</span>
        <span class="action-title">Messages & Consultations</span>
        <p style="color: #666; margin-top: 10px; font-size: 0.9em;">Connect with students and parents</p>
    </a>
    
    <a href="{{ url_for('reports.monthly_summary') }}" class="action-card">
        <span class="action-icon">ðŸ“Š</span>
        <span class="action-title">Reporting Tools</span>
        <p style="color: #666; margin-top: 10px; font-size: 0.9em;">Generate monthly wellness reports</p>
    </a>
</div>

<div class="alerts-section">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
        <h3 style="color: #333; margin: 0;">High Risk Alerts</h3>
        <span style="background: #fee2e2; color: #dc2626; padding: 5px 15px; border-radius: 20px; font-weight: bold; font-size: 0.9em;">
            {{ results|length }} Pending Review
        </span>
    </div>
    
    {% if results %}
    <div style="overflow-x: auto;">
        <table class="alerts-table">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Student Name</th>
                    <th>ID</th>
                    <th>Score</th>
                    <th>Status</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for result in results %}
                <tr>
                    <td>{{ result.created_at.strftime('%Y-%m-%d %H:%M') }}</td>
                    <td><strong>{{ result.user.name }}</strong></td>
                    <td>{{ result.user.student_id }}</td>
                    <td>{{ result.score }}</td>
                    <td style="font-weight: bold; color: #dc2626;">{{ result.risk_level }}</td>
                    <td>
                        <a href="mailto:{{ result.user.email }}" class="btn-action">Email Student</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
        <div style="text-align: center; padding: 40px; color: #888;">
            <p>âœ… Great news! No high-risk cases currently detected.</p>
        </div>
    {% endif %}
</div>
{% endblock %}